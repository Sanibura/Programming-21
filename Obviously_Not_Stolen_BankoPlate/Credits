All the code belongs to daniel and all the credit goes to him.

I just stole it.
